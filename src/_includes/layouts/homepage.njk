{# Uncomment for logging page fields avaliable #}
{# {{ d | log }} #}
<div class="overflow-x-hidden">
    <div class="container relative landing-map landing-map-home">
        <div class="mb-32 md:mb-44">
            <h1 class=" mt-9 mb-16 max-w-660 md:mb-20 md:mt-16">{{ d.introText }}</h1>
            <p class="mb-4 max-w-400 md:mb-5">{{ d.initialText }}</p>
            <svg class="h-6 mb-5 md:mb-6" viewBox="0 0 13 24" xmlns="http://www.w3.org/2000/svg">
                <path fill="white" d="M2.03383e-07 17.1647L6.5 24L13 17.1647L11.8973 15.9898L7.29799 20.8264L7.29799 -2.49243e-07L5.70201 -3.19005e-07L5.70201 20.8264L1.11719 15.9898L2.03383e-07 17.1647Z" />
            </svg>
            <div class="faq-block max-w-400">
                {% documentToHtmlStringWithLinks d.initialDescription.text %}
            </div>
        
        </div>

        <section class="mb-32 md:mb-44">
            <div class="mb-8 flex flex-col md:flex-row md:justify-between md:items-end">
                <h1 class="mb-4 md:mb-0">{{ d.speakersTitle }}</h1>
                {# <h2><a class="underline text-decoration-tedRed" href="{{ d.speakersPage.slug | absoluteUrl }}">Scopri tutti →</a></h2> #}
            </div>
            
            <div x-data="{swiper: null, index: 0}"
                x-init="swiper = initSwiper($refs)"
                class="relative w-full mx-auto flex flex-col"
                >

                <div class="swiper-container w-full mb-8 h-auto" style="overflow: visible !important"  x-ref="container">
                    <div class="swiper-wrapper flex items-stretch">
                        {% for speaker_page in d.speakersCollection.items %}
                            {% set speaker = speaker_page.content.speaker %}
                            <a href="/{{ speaker_page.slug }}" class="swiper-slide rounded-lg no-underline bg-tedGray flex flex-col justify-between shadow overflow-hidden h-auto self-stretch transition ease-in-out delay-100 duration-200 select-none md:hover:scale-110">
                                <div>
                                    <div class=" mb-6">
                                        <picture>
                                            <source type="image/webp" srcset="{{ speaker.image.url }}?w=700&h=700&fit=thumb&fm=webp">
                                            <source type="image/jpeg" srcset="{{ speaker.image.url }}?w=700&h=700&fit=thumb&q=70&fm=jpg">
                                            <img class="w-full" src="{{ speaker.image.url }}?w=500&h=500&fit=thumb&q=70&fm=jpg" alt="{{ speaker.image.name }} {{ speaker.image.surname }}">
                                        </picture>
                                    </div>
                                    <div class="px-4 pb-4">
                                        <p class="mb-2 text-tedDarkWhite">{{ speaker.name }}&nbsp;{{ speaker.surname }}</p>
                                        <h3> {{ speaker.talkTitle }}</h3>
                                        <div class="flex-grow"></div>
                                    </div>
                                </div>
                                <span class="block text-decoration-tedRed underline w-full text-center mt-4 pb-4">Guarda il talk →</span>
                            </a>
                        {% endfor %}
                        
                    </div>
                </div>

                {% if d.speakersCollection.items.length > 2 %}
                    <div class="flex justify-center items-center {% if d.speakersCollection.items.length < 5 %}lg:hidden{% endif %}">
                        <div class="flex items-center">
                            <button @click="{ swiper.slideTo(swiper.activeIndex-1);}" class="bg-white -ml-2 lg:-ml-4 flex justify-center items-center w-10 h-10 rounded-full shadow focus:outline-none">
                                <svg class="w-6" viewBox="0 0 24 21" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M10.449 -1.18467e-06L9.17939e-07 10.5L10.449 21L12.2449 19.1953L4.85131 11.7891L24 11.7891L24 9.21094L4.85131 9.21093L12.2449 1.78125L10.449 -1.18467e-06Z" fill="white"/>
                                </svg>
                            </button>
                        </div>
                        <div class="flex items-center">
                            <button @click="{ swiper.slideTo(swiper.activeIndex+1); }" 
                                    class="bg-white -mr-2 lg:-mr-4 flex justify-center items-center w-10 h-10 rounded-full shadow focus:outline-none">
                                <svg class="w-6" viewBox="0 0 24 21" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M13.551 21L24 10.5L13.551 0L11.7551 1.80469L19.1487 9.21094H0V11.7891H19.1487L11.7551 19.2188L13.551 21Z" fill="white"/>
                                </svg>

                            </button>
                        </div>
                    </div>
                {% endif %}

            </div>
        </section>

        <section class="grid grid-cols-1 mb-32 md:mb-44 md:grid-cols-12">

            {% set form=d.newsletterForm %}
            {% set class="mb-12 md:col-span-5 md:mb-0" %}
            {% include "newsletter.njk" %}

            <div class="md:col-span-5 md:col-end-12">
                <p class="mb-4">E seguici su:</p>
                <h2><a class="text-decoration-tedRed" href="{{ settings.instagram }}" target="_blank">Instagram ↗</a></h2>
                <h2><a class="text-decoration-tedRed" href="{{ settings.facebook }}" target="_blank">Facebook ↗</a></h2>
                <h2><a class="text-decoration-tedRed" href="{{ settings.linkedin }}" target="_blank">Linkedin ↗</a></h2>
            </div>
        
        </section>

        {% if d.ctaTickets %}
            {% set class="mb-32 md:mb-44" %}
            {% set cta=d.ctaTickets %}
            {% include "ctaTickets.njk" %}
        {% endif %}

        {% if d.ctaLive %}
            {% set class="mb-32 md:mb-44" %}
            {% set cta=d.ctaLive %}
            {% include "ctaLive.njk" %}
        {% endif %}

        <section class="grid grid-cols-1 mb-32 gap-y-24 md:mb-44 lg:grid-cols-2 lg:gap-x-32">
            {% for item in d.textBlocksCollection.items %}
                <div class="faq-block max-w-sm">
                    {% documentToHtmlStringWithLinks item.text %}
                </div>
            {% endfor %}
        </section> 

        <section class="grid grid-cols-1 mb-28 md:grid-cols-12 md:gap-x-6">
            <picture class="mb-12 md:mb-0 md:col-span-6">
                <source type="image/webp" srcset="{{ d.tedBlock.image.url }}?w=700&fm=webp 1x, {{ d.tedBlock.image.url }}?w=1400&fm=webp 2x">
                <source type="image/jpeg" srcset="{{ d.tedBlock.image.url }}?w=700&q=60&fm=jpg 1x, {{ d.tedBlock.image.url }}?w=1400&q=60&fm=jpg 2x">
                <img class="object-cover w-full" src="{{ d.tedBlock.image.url }}?w=700&q=60&fm=jpg" alt="TED & TEDx"/>
            </picture>

            <div class="faq-block max-w-615 md:col-span-4 md:col-start-8">

                {% documentToHtmlStringWithLinks d.tedBlock.text %}

            </div>
        
        </section>

    </div>
</div>

<script src="/assets/js/swiper.min.js"></script>
<script>
    // speakers slider
    function initSwiper(refs){
        swiper = new Swiper(refs.container, {
            loop: false,
            slidesPerView: 1,
            spaceBetween: 40,
        
            breakpoints: {
                540: {
                    slidesPerView: 2,
                    spaceBetween: 40,
                },
                1024: {
                    slidesPerView: 3,
                    spaceBetween: 60,
                },
                1400: {
                    slidesPerView: 4,
                    spaceBetween: 60,
                },
            },
        });
        swiper.on('transitionEnd', function() {
            index=swiper.realIndex;
        });
        return swiper;
    }
</script>